# models/marts/composite_kpis/composite_kpis_simplified.yml
version: 2

models:
  - name: composite_kpis_simplified
    description: "Simplified cross-functional KPIs for executive reporting and channel optimization"
    columns:
      - name: report_date
        description: "Date of marketing activity"
        data_tests:
          - not_null
      - name: country_code
        description: "Country where ads were served"
      - name: os_name
        description: "Platform (ios/android)"
      - name: acquisition_channel
        description: "Marketing channel/ad network"
        data_tests:
          - not_null
      - name: campaign_name
        description: "Campaign identifier"
      - name: campaign_creative
        description: "Creative/ad variant"
      - name: roas
        description: "Return on Ad Spend - total_revenue/total_ad_spend. >1.0 indicates profitability"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
      - name: channel_profitability_status
        description: |
          Channel profitability classification:
          - profitable: ROAS >= 1.0 (positive unit economics)
          - reaching_profitability: ROAS 0.5-1.0 (approaching profitability)
          - early_optimization: ROAS 0.2-0.5 (early optimization phase)
          - unprofitable: ROAS < 0.2 (requires intervention)
        data_tests:
          - accepted_values:
              values: ['profitable', 'reaching_profitability', 'early_optimization', 'unprofitable']
      - name: traffic_quality
        description: |
          Traffic quality assessment based on engagement and attribution accuracy:
          - High Quality: CTR >2% and <10% attribution discrepancy
          - Medium Quality: CTR >1% and <20% attribution discrepancy
          - Low Quality: Poor engagement or high risk indicators
        data_tests:
          - accepted_values:
              values: ['high', 'medium', 'low']